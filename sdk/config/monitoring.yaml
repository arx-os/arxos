# Monitoring Configuration
# Controls metrics tracking, alerting, and dashboard generation

# Metrics thresholds and alerting
metrics:
  generation_time:
    threshold: 300  # 5 minutes
    alert: true
    critical_threshold: 600  # 10 minutes
    unit: seconds
  
  test_coverage:
    threshold: 80  # 80%
    alert: true
    critical_threshold: 70
    unit: percentage
  
  build_success_rate:
    threshold: 95  # 95%
    alert: true
    critical_threshold: 90
    unit: percentage
  
  publish_success_rate:
    threshold: 99  # 99%
    alert: true
    critical_threshold: 95
    unit: percentage
  
  documentation_coverage:
    threshold: 90  # 90%
    alert: true
    critical_threshold: 80
    unit: percentage
  
  security_issues:
    threshold: 0  # 0 issues
    alert: true
    critical_threshold: 0
    unit: count
  
  performance_regression:
    threshold: 10  # 10% max regression
    alert: true
    critical_threshold: 20
    unit: percentage
  
  code_quality_score:
    threshold: 8.0  # 8.0/10
    alert: true
    critical_threshold: 7.0
    unit: score
  
  dependency_vulnerabilities:
    threshold: 0  # 0 vulnerabilities
    alert: true
    critical_threshold: 0
    unit: count

# Alert configuration
alerts:
  email:
    enabled: true
    smtp_server: smtp.gmail.com
    smtp_port: 587
    from_email: alerts@arxos.com
    to_emails:
      - dev-team@arxos.com
      - sdk-team@arxos.com
      - oncall@arxos.com
    subject_template: "[{severity}] Arxos SDK Alert: {service} ({language})"
    html_template: true
  
  slack:
    enabled: true
    webhook_url_env: SLACK_WEBHOOK_URL
    channel: "#sdk-alerts"
    username: "Arxos SDK Bot"
    icon_emoji: ":warning:"
    color_mapping:
      info: "#36a64f"
      warning: "#ff8c00"
      critical: "#ff0000"
  
  webhook:
    enabled: false
    url_env: WEBHOOK_URL
    timeout: 30
    retries: 3
  
  pagerduty:
    enabled: false
    api_key_env: PAGERDUTY_API_KEY
    service_id_env: PAGERDUTY_SERVICE_ID
  
  teams:
    enabled: false
    webhook_url_env: TEAMS_WEBHOOK_URL

# Data retention settings
retention:
  metrics_days: 90
  reports_days: 30
  logs_days: 7
  alerts_days: 14
  backups_days: 365

# Services to monitor
services:
  - arx-backend
  - arx-cmms
  - arx-database

# Languages to monitor
languages:
  - typescript
  - python
  - go
  - java
  - csharp
  - php

# Dashboard configuration
dashboard:
  auto_generate: true
  update_interval: 300  # 5 minutes
  include_charts: true
  include_tables: true
  include_alerts: true
  
  # Chart configurations
  charts:
    build_success_rate:
      type: line
      time_range: 30  # days
      show_threshold: true
    
    test_coverage:
      type: line
      time_range: 30
      show_threshold: true
    
    generation_time:
      type: line
      time_range: 7
      show_threshold: true
    
    publications:
      type: bar
      time_range: 7
      group_by: language
    
    alerts:
      type: pie
      time_range: 7
      group_by: severity

# Performance monitoring
performance:
  track_response_times: true
  track_throughput: true
  track_error_rates: true
  track_resource_usage: true
  
  # Resource thresholds
  cpu_threshold: 80  # 80%
  memory_threshold: 85  # 85%
  disk_threshold: 90  # 90%
  network_threshold: 80  # 80%

# Security monitoring
security:
  scan_dependencies: true
  scan_code: true
  scan_secrets: true
  track_vulnerabilities: true
  
  # Security thresholds
  max_vulnerabilities: 0
  max_secrets_exposed: 0
  require_security_scan: true

# Quality monitoring
quality:
  track_code_coverage: true
  track_duplication: true
  track_complexity: true
  track_maintainability: true
  
  # Quality thresholds
  min_code_coverage: 80
  max_duplication: 10  # 10%
  max_complexity: 10
  min_maintainability: 8.0

# Notification schedules
notification_schedules:
  immediate:
    - critical_alerts
    - security_issues
    - build_failures
  
  hourly:
    - performance_alerts
    - quality_alerts
  
  daily:
    - summary_reports
    - trend_analysis
  
  weekly:
    - comprehensive_reports
    - metric_reviews

# Escalation rules
escalation:
  enabled: true
  rules:
    - condition: "critical_alerts > 3 in 1 hour"
      action: "escalate_to_team_lead"
      delay: 0
    
    - condition: "build_success_rate < 90 for 2 hours"
      action: "escalate_to_dev_team"
      delay: 120  # 2 minutes
    
    - condition: "security_issues > 0"
      action: "escalate_to_security_team"
      delay: 0
    
    - condition: "performance_regression > 20%"
      action: "escalate_to_performance_team"
      delay: 300  # 5 minutes

# Reporting configuration
reporting:
  generate_reports: true
  report_formats:
    - html
    - pdf
    - json
    - csv
  
  report_schedules:
    daily:
      time: "09:00"
      timezone: "UTC"
      include: ["summary", "alerts", "metrics"]
    
    weekly:
      day: "monday"
      time: "10:00"
      timezone: "UTC"
      include: ["comprehensive", "trends", "recommendations"]
    
    monthly:
      day: 1
      time: "11:00"
      timezone: "UTC"
      include: ["full_analysis", "forecasting", "improvements"]

# Integration settings
integrations:
  github:
    enabled: true
    track_commits: true
    track_pull_requests: true
    track_issues: true
  
  jenkins:
    enabled: false
    url_env: JENKINS_URL
    username_env: JENKINS_USERNAME
    password_env: JENKINS_PASSWORD
  
  jira:
    enabled: false
    url_env: JIRA_URL
    username_env: JIRA_USERNAME
    password_env: JIRA_PASSWORD
  
  prometheus:
    enabled: false
    url_env: PROMETHEUS_URL
    metrics_endpoint: "/metrics"
  
  grafana:
    enabled: false
    url_env: GRAFANA_URL
    api_key_env: GRAFANA_API_KEY

# Database configuration
database:
  type: sqlite
  path: "data/monitoring.db"
  backup_enabled: true
  backup_interval: 86400  # 24 hours
  max_backups: 7
  
  # Optional: PostgreSQL configuration
  postgresql:
    enabled: false
    host_env: POSTGRES_HOST
    port_env: POSTGRES_PORT
    database_env: POSTGRES_DB
    username_env: POSTGRES_USER
    password_env: POSTGRES_PASSWORD 
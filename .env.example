# ArxOS Environment Configuration
# Copy this file to .env and update values for your environment

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostGIS Database (Primary)
POSTGRES_DB=arxos
POSTGRES_USER=arxos
POSTGRES_PASSWORD=secure_password_$(openssl rand -hex 16)
POSTGIS_HOST=localhost
POSTGIS_PORT=5432

# Database Type Selection
ARXOS_DB_TYPE=postgis  # postgis, sqlite, hybrid

# SQLite Database (Fallback)
ARXOS_DB_PATH=./data/arxos.db

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# API Server
ARXOS_API_PORT=8080
ARXOS_LOG_LEVEL=info  # debug, info, warn, error
ARXOS_STATE_DIR=./data/state
ARXOS_CACHE_DIR=./data/cache

# Daemon Configuration
DAEMON_WATCH_PATHS=/data/ifc
DAEMON_POLL_INTERVAL=5s
DAEMON_AUTO_EXPORT=true
DAEMON_AUTO_IMPORT=true
DAEMON_MAX_WORKERS=4

# =============================================================================
# SECURITY
# =============================================================================

# Authentication
JWT_SECRET=secure_jwt_secret_$(openssl rand -hex 32)
JWT_EXPIRY=24h
SESSION_TIMEOUT=72h
ARXOS_BCRYPT_COST=12

# API Rate Limiting
API_RATE_LIMIT=100
API_RATE_BURST=200

# CORS Settings
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# =============================================================================
# DEVELOPMENT TOOLS (Docker profiles)
# =============================================================================

# PgAdmin (profile: debug)
PGADMIN_EMAIL=admin@arxos.local
PGADMIN_PASSWORD=dev_admin_$(openssl rand -hex 8)
PGADMIN_PORT=5050

# Redis Cache (profile: cache)
REDIS_HOST=localhost
REDIS_PASSWORD=
REDIS_DB=0
ARXOS_REDIS_TLS_ENABLED=false
ARXOS_REDIS_TLS_CERT_PATH=/etc/ssl/certs/redis-cert.pem
ARXOS_REDIS_TLS_KEY_PATH=/etc/ssl/private/redis-key.pem
ARXOS_REDIS_TLS_CACERT_PATH=/etc/ssl/certs/redis-ca-cert.pem
REDIS_PORT=6379
CACHE_TYPE=memory  # memory, redis

# =============================================================================
# MONITORING (Docker profile: monitoring)
# =============================================================================

# Prometheus
PROMETHEUS_PORT=9090
METRICS_ENABLED=true

# Grafana
GRAFANA_PORT=3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=dev_monitoring_$(openssl rand -hex 8)

# Loki
LOKI_PORT=3100

# Jaeger
JAEGER_UI_PORT=16686
JAEGER_COLLECTOR_PORT=14268

# =============================================================================
# PRODUCTION SETTINGS
# =============================================================================

# Performance
ARXOS_MAX_REQUEST_SIZE=10485760  # 10MB
CONNECTION_POOL_SIZE=25
MAX_IDLE_CONNECTIONS=10

# TLS/SSL Configuration
ARXOS_TLS_MIN_VERSION=1.2
ARXOS_TLS_CIPHERS=ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305
ARXOS_TLS_CURVE_PREFERENCES=P-256:P-384:P-521
ARXOS_TLS_PRIVATE_KEY_PASSPHRASE=

ARXOS_ENABLE_TLS=false
ARXOS_TLS_MIN_VERSION=1.2
ARXOS_TLS_CIPHERS=ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305
ARXOS_TLS_CURVE_PREFERENCES=P-256:P-384:P-521
ARXOS_TLS_PRIVATE_KEY_PASSPHRASE=
ARXOS_TLS_CERT_PATH=/etc/ssl/certs/arxos.crt
ARXOS_TLS_KEY_PATH=/etc/ssl/private/arxos.key

# Telemetry
ARXOS_TELEMETRY=false

# =============================================================================
# BACKUP & STORAGE
# =============================================================================

# Backup Configuration
BACKUP_ENABLED=false
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=./backups

# Storage Configuration
STORAGE_TYPE=local  # local, s3, azure
STORAGE_PATH=./storage

# =============================================================================
# ARXOS SPECIFIC
# =============================================================================

# Building Management
ARXOS_ID_PREFIX=ARXOS
MAX_BUILDING_SIZE_MB=500
MAX_IFC_IMPORT_SIZE_MB=100

# Repository Settings
REPO_VERSION_LIMIT=100
REPO_ENABLE_COMPRESSION=true

# Export Formats
ENABLE_BIM_EXPORT=true
ENABLE_CSV_EXPORT=true
ENABLE_JSON_EXPORT=true
ENABLE_PDF_EXPORT=false  # Requires additional dependencies
# =============================================================================
# IFC SERVICE CONFIGURATION
# =============================================================================

# IFC Processing Service (Python IfcOpenShell)
ARXOS_IFC_SERVICE_URL=http://localhost:5000
ARXOS_IFC_SERVICE_ENABLED=true
ARXOS_IFC_SERVICE_TIMEOUT=30s
ARXOS_IFC_SERVICE_RETRIES=3
ARXOS_IFC_MAX_FILE_SIZE=200MB
ARXOS_IFC_FALLBACK_ENABLED=true
ARXOS_IFC_FALLBACK_PARSER=native

# IFC Performance Settings
ARXOS_IFC_CACHE_ENABLED=true
ARXOS_IFC_CACHE_TTL=1h
ARXOS_IFC_CIRCUIT_BREAKER_ENABLED=true
ARXOS_IFC_CIRCUIT_BREAKER_THRESHOLD=5
ARXOS_IFC_CIRCUIT_BREAKER_TIMEOUT=60s


# =============================================================================
# MOBILE APPLICATION CONFIGURATION
# =============================================================================

# Mobile API Configuration
ARXOS_MOBILE_API_BASE_URL=http://localhost:8080/api/v1
ARXOS_MOBILE_SYNC_INTERVAL=300s
ARXOS_MOBILE_OFFLINE_STORAGE_LIMIT=104857600  # 100MB
ARXOS_MOBILE_MAX_SYNC_RETRIES=5

# AR Features
ARXOS_MOBILE_AR_ENABLED=true
ARXOS_MOBILE_AR_CAMERA_PERMISSION_REQUIRED=true
ARXOS_MOBILE_AR_LOCATION_PERMISSION_REQUIRED=true

# Mobile Push Notifications
ARXOS_MOBILE_PUSH_NOTIFICATIONS_ENABLED=false
ARXOS_MOBILE_FCM_SERVER_KEY=
ARXOS_MOBILE_APNS_CERT_PATH=


# Enhanced Database Security
POSTGIS_SSLMODE=require
POSTGIS_SSL_CERT_PATH=/etc/ssl/certs/client-cert.pem
POSTGIS_SSL_KEY_PATH=/etc/ssl/private/client-key.pem
POSTGIS_SSL_ROOT_CERT_PATH=/etc/ssl/certs/ca-cert.pem


# Redis Additional Configuration
ARXOS_REDIS_MAX_RETRIES=3
ARXOS_REDIS_RETRY_BACKOFF=100ms
ARXOS_REDIS_POOL_SIZE=10
ARXOS_REDIS_POOL_MIN_IDLE=5


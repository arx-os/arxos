# Version Management Configuration
# Controls versioning strategy, changelog generation, and release automation

# Versioning strategy
versioning:
  strategy: semantic  # semantic, simple, or custom
  auto_increment: true
  require_changelog: true
  git_tags: true
  enforce_semantic_commits: true
  breaking_change_detection: true

# Services and their version configurations
services:
  arx-backend:
    current_version: "1.0.0"
    version_file: package.json
    changelog_file: CHANGELOG.md
    breaking_changes: false
    last_release_date: "2024-01-01"
    release_notes_template: |
      ## What's New
      {features}

      ## Bug Fixes
      {bugfixes}

      ## Breaking Changes
      {breaking_changes}



  arx-cmms:
    current_version: "1.0.0"
    version_file: package.json
    changelog_file: CHANGELOG.md
    breaking_changes: false
    last_release_date: "2024-01-01"
    release_notes_template: |
      ## What's New
      {features}

      ## Bug Fixes
      {bugfixes}

      ## Breaking Changes
      {breaking_changes}

  arx-database:
    current_version: "1.0.0"
    version_file: package.json
    changelog_file: CHANGELOG.md
    breaking_changes: false
    last_release_date: "2024-01-01"
    release_notes_template: |
      ## What's New
      {features}

      ## Bug Fixes
      {bugfixes}

      ## Breaking Changes
      {breaking_changes}

# Language-specific version file configurations
languages:
  typescript:
    version_file: package.json
    version_field: version
    update_strategy: replace
    backup_original: true

  python:
    version_file: setup.py
    version_field: version
    update_strategy: regex
    backup_original: true

  go:
    version_file: go.mod
    version_field: version
    update_strategy: regex
    backup_original: true

  java:
    version_file: pom.xml
    version_field: version
    update_strategy: xml
    backup_original: true

  csharp:
    version_file: "*.csproj"
    version_field: Version
    update_strategy: xml
    backup_original: true

  php:
    version_file: composer.json
    version_field: version
    update_strategy: replace
    backup_original: true

# Changelog configuration
changelog:
  format: markdown
  include_commit_hashes: true
  include_author: true
  include_date: true
  group_by_type: true
  types:
    - feature
    - bugfix
    - breaking
    - documentation
    - performance
    - security
    - other

  type_labels:
    feature: "‚ú® Features"
    bugfix: "üêõ Bug Fixes"
    breaking: "üí• Breaking Changes"
    documentation: "üìö Documentation"
    performance: "‚ö° Performance"
    security: "üîí Security"
    other: "üîß Other"

# Git configuration
git:
  create_tags: true
  push_tags: true
  commit_changes: true
  branch_protection: true
  require_clean_working_directory: true
  tag_format: "{service}-v{version}"
  commit_message_format: "chore: release {service} v{version}"

  # Branch naming conventions
  branches:
    main: main
    develop: develop
    feature: feature/{service}-{description}
    hotfix: hotfix/{service}-{description}
    release: release/{service}-v{version}

# Release automation
release:
  auto_detect_changes: true
  require_approval: true
  approval_team: ["sdk-team", "dev-team"]
  minimum_changes_for_release: 1

  # Release types and their triggers
  types:
    patch:
      triggers: ["bugfix", "documentation", "other"]
      auto_approve: true
      require_tests: true

    minor:
      triggers: ["feature", "performance"]
      auto_approve: false
      require_tests: true
      require_review: true

    major:
      triggers: ["breaking"]
      auto_approve: false
      require_tests: true
      require_review: true
      require_approval: true

# Commit message parsing
commit_parsing:
  conventional_commits: true
  patterns:
    feature: "^(feat|feature|add|new)"
    bugfix: "^(fix|bug|patch)"
    breaking: "^(break|breaking)"
    documentation: "^(doc|readme|docs)"
    performance: "^(perf|performance)"
    security: "^(sec|security)"
    other: ".*"

  # Extract scope from commit messages
  scope_extraction: true
  scope_pattern: "\\(([^)]+)\\)"

# Notification settings
notifications:
  release_created:
    email: true
    slack: true
    webhook: false

  release_failed:
    email: true
    slack: true
    webhook: true

  approval_required:
    email: true
    slack: true
    webhook: false

# Validation rules
validation:
  require_tests_passing: true
  require_coverage_threshold: 80
  require_security_scan: true
  require_documentation: true
  require_changelog: true

  # Version format validation
  version_format: "^\\d+\\.\\d+\\.\\d+$"
  allow_prerelease: false
  allow_build_metadata: false

# Backup and rollback
backup:
  enabled: true
  backup_version_files: true
  backup_changelog: true
  retention_days: 30

rollback:
  enabled: true
  max_rollback_versions: 3
  require_approval: true

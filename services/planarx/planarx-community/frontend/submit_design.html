<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Design - Planarx Community</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .upload-area { transition: all 0.3s ease; }
        .upload-area:hover { transform: translateY(-2px); }
        .progress-bar { transition: width 0.5s ease; }
        .preview-container { min-height: 400px; }
        .arxide-frame { border: 2px solid #e5e7eb; border-radius: 8px; }
        .milestone-card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; }
        .milestone-card:hover { border-color: #3b82f6; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation Header -->
    <nav class="bg-white shadow-lg border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <a href="/" class="text-xl font-bold text-gray-900">Planarx Community</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="/discover" class="text-gray-500 hover:text-gray-700">Discover</a>
                    <a href="/submit" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">Submit Design</a>
                    <div class="relative">
                        <button class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-user-circle text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Submission Progress -->
        <div class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-3xl font-bold text-gray-900">Submit Your Design</h1>
                <div class="text-sm text-gray-500">Step <span id="current-step">1</span> of 4</div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div class="bg-blue-600 h-2 rounded-full progress-bar" id="progress-bar" style="width: 25%"></div>
            </div>
            <div class="flex justify-between mt-2 text-sm text-gray-600">
                <span>Design Upload</span>
                <span>Project Details</span>
                <span>ArxIDE Preview</span>
                <span>Submit & Review</span>
            </div>
        </div>

        <!-- Step 1: Design Upload -->
        <div id="step-1" class="step-content">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Upload Your Design</h2>
                
                <!-- File Upload Area -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center upload-area" id="upload-area">
                    <div class="mb-4">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400"></i>
                    </div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">Drop your design files here</h3>
                    <p class="text-gray-500 mb-4">or click to browse</p>
                    <input type="file" id="file-input" class="hidden" accept=".svg,.dxf,.dwg,.rvt,.ifc" multiple>
                    <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors" onclick="document.getElementById('file-input').click()">
                        Choose Files
                    </button>
                    <div class="mt-4 text-sm text-gray-500">
                        Supported formats: SVG, DXF, DWG, RVT, IFC (Max 50MB)
                    </div>
                </div>

                <!-- Upload Progress -->
                <div id="upload-progress" class="hidden mt-6">
                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                        <span>Uploading...</span>
                        <span id="upload-percentage">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-green-600 h-2 rounded-full progress-bar" id="upload-progress-bar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Uploaded Files -->
                <div id="uploaded-files" class="mt-6 hidden">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Uploaded Files</h4>
                    <div id="files-list" class="space-y-3">
                        <!-- Files will be listed here -->
                    </div>
                </div>

                <div class="mt-8 flex justify-between">
                    <button class="px-6 py-3 text-gray-600 hover:text-gray-800" disabled>Previous</button>
                    <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors" onclick="nextStep()">
                        Next: Project Details
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Project Details -->
        <div id="step-2" class="step-content hidden">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Project Details</h2>
                
                <form id="project-form" class="space-y-6">
                    <!-- Basic Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Project Title</label>
                            <input type="text" id="project-title" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                            <select id="project-category" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                <option value="">Select Category</option>
                                <option value="residential">Residential</option>
                                <option value="commercial">Commercial</option>
                                <option value="industrial">Industrial</option>
                                <option value="infrastructure">Infrastructure</option>
                                <option value="landscape">Landscape</option>
                                <option value="interior">Interior Design</option>
                                <option value="conceptual">Conceptual</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                        <textarea id="project-description" rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Describe your project, its purpose, and key features..." required></textarea>
                    </div>

                    <!-- Tags -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                        <div class="flex flex-wrap gap-2 mb-2" id="tags-container">
                            <!-- Tags will be added here -->
                        </div>
                        <div class="flex">
                            <input type="text" id="tag-input" class="flex-1 border border-gray-300 rounded-l-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Add tags...">
                            <button type="button" onclick="addTag()" class="bg-blue-600 text-white px-4 py-2 rounded-r-md hover:bg-blue-700 transition-colors">
                                Add
                            </button>
                        </div>
                    </div>

                    <!-- Funding Information -->
                    <div class="border-t border-gray-200 pt-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Crowdfunding Setup</h3>
                        
                        <div class="flex items-center mb-4">
                            <input type="checkbox" id="enable-crowdfunding" class="mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <label for="enable-crowdfunding" class="text-sm font-medium text-gray-700">Enable crowdfunding for this project</label>
                        </div>
                        
                        <div id="crowdfunding-fields" class="hidden space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Funding Goal ($)</label>
                                    <input type="number" id="funding-goal" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" min="0" step="100" placeholder="5000">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Campaign Duration (days)</label>
                                    <input type="number" id="campaign-duration" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" min="7" max="90" placeholder="30">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Pledge ($)</label>
                                    <input type="number" id="min-pledge" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" min="1" placeholder="10">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Funding Description</label>
                                <textarea id="funding-description" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Explain how the funds will be used and what backers can expect..."></textarea>
                            </div>
                            
                            <!-- Milestone Setup -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Funding Milestones</label>
                                <div id="milestones-container" class="space-y-3">
                                    <!-- Milestones will be added here -->
                                </div>
                                <button type="button" onclick="addMilestone()" class="mt-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors text-sm">
                                    <i class="fas fa-plus mr-2"></i>Add Milestone
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Project Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Project Duration (days)</label>
                            <input type="number" id="project-duration" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" min="1">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Team Size</label>
                            <input type="number" id="team-size" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" min="1">
                        </div>
                    </div>

                    <!-- Project Images -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Project Images</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                            <div class="mb-4">
                                <i class="fas fa-images text-3xl text-gray-400"></i>
                            </div>
                            <p class="text-gray-500 mb-4">Upload images to showcase your project</p>
                            <input type="file" id="image-input" class="hidden" accept="image/*" multiple>
                            <button type="button" onclick="document.getElementById('image-input').click()" class="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors">
                                Choose Images
                            </button>
                        </div>
                        <div id="project-images" class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 hidden">
                            <!-- Images will be displayed here -->
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button type="button" class="px-6 py-3 text-gray-600 hover:text-gray-800" onclick="previousStep()">Previous</button>
                        <button type="button" class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors" onclick="nextStep()">
                            Next: ArxIDE Preview
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Step 3: ArxIDE Preview -->
        <div id="step-3" class="step-content hidden">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">ArxIDE Preview</h2>
                
                <div class="preview-container">
                    <div class="bg-gray-100 rounded-lg p-4 mb-4">
                        <h3 class="text-lg font-medium text-gray-900 mb-2">Interactive Design Preview</h3>
                        <p class="text-gray-600">Your design will be rendered in ArxIDE for interactive viewing and collaboration.</p>
                    </div>
                    
                    <div class="arxide-frame bg-white border-2 border-gray-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="text-lg font-medium text-gray-900">ArxIDE Workspace</h4>
                            <div class="flex space-x-2">
                                <button class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700">Zoom In</button>
                                <button class="px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700">Reset View</button>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-8 text-center">
                            <i class="fas fa-cube text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600">Design preview will be loaded here</p>
                            <p class="text-sm text-gray-500 mt-2">Interactive 3D visualization and collaboration tools</p>
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between">
                    <button class="px-6 py-3 text-gray-600 hover:text-gray-800" onclick="previousStep()">Previous</button>
                    <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors" onclick="nextStep()">
                        Next: Submit & Review
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 4: Submit & Review -->
        <div id="step-4" class="step-content hidden">
            <div class="bg-white rounded-lg shadow-md p-8">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Submit & Review</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Project Summary -->
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Project Summary</h3>
                        <div class="bg-gray-50 rounded-lg p-4 space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Title:</span>
                                <span id="summary-title" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Category:</span>
                                <span id="summary-category" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Files:</span>
                                <span id="summary-files" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Tags:</span>
                                <span id="summary-tags" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Crowdfunding:</span>
                                <span id="summary-crowdfunding" class="font-medium">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Funding Summary -->
                    <div id="funding-summary" class="hidden">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Funding Summary</h3>
                        <div class="bg-blue-50 rounded-lg p-4 space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Goal:</span>
                                <span id="summary-goal" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Duration:</span>
                                <span id="summary-duration" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Milestones:</span>
                                <span id="summary-milestones" class="font-medium">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Min Pledge:</span>
                                <span id="summary-min-pledge" class="font-medium">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Terms and Conditions -->
                <div class="mt-8">
                    <div class="flex items-start mb-4">
                        <input type="checkbox" id="terms-accept" class="mr-3 mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                        <label for="terms-accept" class="text-sm text-gray-700">
                            I agree to the <a href="#" class="text-blue-600 hover:text-blue-800">Terms of Service</a> and 
                            <a href="#" class="text-blue-600 hover:text-blue-800">Community Guidelines</a>
                        </label>
                    </div>
                    
                    <div class="flex items-start mb-4" id="escrow-terms" style="display: none;">
                        <input type="checkbox" id="escrow-accept" class="mr-3 mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                        <label for="escrow-accept" class="text-sm text-gray-700">
                            I understand that funds will be held in escrow and released based on milestone approvals by the governance board
                        </label>
                    </div>
                </div>

                <div class="mt-8 flex justify-between">
                    <button class="px-6 py-3 text-gray-600 hover:text-gray-800" onclick="previousStep()">Previous</button>
                    <button id="submit-button" class="bg-green-600 text-white px-8 py-3 rounded-md hover:bg-green-700 transition-colors" onclick="submitProject()" disabled>
                        Submit Project
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let uploadedFiles = [];
        let projectTags = [];
        let milestones = [];
        let projectImages = [];

        // Step navigation
        function nextStep() {
            if (currentStep < 4) {
                document.getElementById(`step-${currentStep}`).classList.add('hidden');
                currentStep++;
                document.getElementById(`step-${currentStep}`).classList.remove('hidden');
                updateProgress();
                updateSummary();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                document.getElementById(`step-${currentStep}`).classList.add('hidden');
                currentStep--;
                document.getElementById(`step-${currentStep}`).classList.remove('hidden');
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = (currentStep / 4) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('current-step').textContent = currentStep;
        }

        // File upload handling
        document.getElementById('file-input').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            uploadedFiles = files;
            displayUploadedFiles();
        });

        function displayUploadedFiles() {
            const container = document.getElementById('files-list');
            container.innerHTML = '';
            
            uploadedFiles.forEach((file, index) => {
                const fileDiv = document.createElement('div');
                fileDiv.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                fileDiv.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-file text-blue-600 mr-3"></i>
                        <span class="text-sm font-medium">${file.name}</span>
                        <span class="text-xs text-gray-500 ml-2">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
                    </div>
                    <button onclick="removeFile(${index})" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                container.appendChild(fileDiv);
            });
            
            if (uploadedFiles.length > 0) {
                document.getElementById('uploaded-files').classList.remove('hidden');
            }
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            displayUploadedFiles();
        }

        // Tag management
        function addTag() {
            const input = document.getElementById('tag-input');
            const tag = input.value.trim();
            
            if (tag && !projectTags.includes(tag)) {
                projectTags.push(tag);
                displayTags();
                input.value = '';
            }
        }

        function displayTags() {
            const container = document.getElementById('tags-container');
            container.innerHTML = '';
            
            projectTags.forEach((tag, index) => {
                const tagSpan = document.createElement('span');
                tagSpan.className = 'inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800';
                tagSpan.innerHTML = `
                    ${tag}
                    <button onclick="removeTag(${index})" class="ml-2 text-blue-600 hover:text-blue-800">
                        <i class="fas fa-times text-xs"></i>
                    </button>
                `;
                container.appendChild(tagSpan);
            });
        }

        function removeTag(index) {
            projectTags.splice(index, 1);
            displayTags();
        }

        // Crowdfunding toggle
        document.getElementById('enable-crowdfunding').addEventListener('change', function(e) {
            const fields = document.getElementById('crowdfunding-fields');
            const summary = document.getElementById('funding-summary');
            const escrowTerms = document.getElementById('escrow-terms');
            
            if (e.target.checked) {
                fields.classList.remove('hidden');
                summary.classList.remove('hidden');
                escrowTerms.style.display = 'block';
            } else {
                fields.classList.add('hidden');
                summary.classList.add('hidden');
                escrowTerms.style.display = 'none';
            }
        });

        // Milestone management
        function addMilestone() {
            const milestoneId = 'milestone-' + Date.now();
            const milestoneHtml = `
                <div class="milestone-card" id="${milestoneId}">
                    <div class="flex justify-between items-start mb-3">
                        <h4 class="font-medium text-gray-900">Milestone ${milestones.length + 1}</h4>
                        <button onclick="removeMilestone('${milestoneId}')" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                            <input type="text" class="milestone-title w-full border border-gray-300 rounded-md px-3 py-2 text-sm" placeholder="e.g., Design Phase Complete">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Amount ($)</label>
                            <input type="number" class="milestone-amount w-full border border-gray-300 rounded-md px-3 py-2 text-sm" placeholder="1000" min="0">
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea class="milestone-description w-full border border-gray-300 rounded-md px-3 py-2 text-sm" rows="2" placeholder="Describe what will be delivered..."></textarea>
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
                        <input type="date" class="milestone-due-date w-full border border-gray-300 rounded-md px-3 py-2 text-sm">
                    </div>
                </div>
            `;
            
            document.getElementById('milestones-container').insertAdjacentHTML('beforeend', milestoneHtml);
            milestones.push(milestoneId);
        }

        function removeMilestone(milestoneId) {
            const element = document.getElementById(milestoneId);
            element.remove();
            milestones = milestones.filter(id => id !== milestoneId);
        }

        // Summary update
        function updateSummary() {
            if (currentStep === 4) {
                document.getElementById('summary-title').textContent = document.getElementById('project-title').value || '-';
                document.getElementById('summary-category').textContent = document.getElementById('project-category').value || '-';
                document.getElementById('summary-files').textContent = uploadedFiles.length + ' files';
                document.getElementById('summary-tags').textContent = projectTags.join(', ') || '-';
                
                const crowdfundingEnabled = document.getElementById('enable-crowdfunding').checked;
                document.getElementById('summary-crowdfunding').textContent = crowdfundingEnabled ? 'Enabled' : 'Disabled';
                
                if (crowdfundingEnabled) {
                    document.getElementById('summary-goal').textContent = '$' + (document.getElementById('funding-goal').value || '0');
                    document.getElementById('summary-duration').textContent = (document.getElementById('campaign-duration').value || '0') + ' days';
                    document.getElementById('summary-milestones').textContent = milestones.length + ' milestones';
                    document.getElementById('summary-min-pledge').textContent = '$' + (document.getElementById('min-pledge').value || '0');
                }
            }
        }

        // Submit project
        function submitProject() {
            const termsAccepted = document.getElementById('terms-accept').checked;
            const crowdfundingEnabled = document.getElementById('enable-crowdfunding').checked;
            const escrowAccepted = !crowdfundingEnabled || document.getElementById('escrow-accept').checked;
            
            if (!termsAccepted || (crowdfundingEnabled && !escrowAccepted)) {
                alert('Please accept all required terms and conditions.');
                return;
            }
            
            // Collect project data
            const projectData = {
                title: document.getElementById('project-title').value,
                category: document.getElementById('project-category').value,
                description: document.getElementById('project-description').value,
                tags: projectTags,
                files: uploadedFiles.map(f => f.name),
                duration: document.getElementById('project-duration').value,
                teamSize: document.getElementById('team-size').value,
                crowdfunding: {
                    enabled: crowdfundingEnabled,
                    goal: document.getElementById('funding-goal').value,
                    duration: document.getElementById('campaign-duration').value,
                    minPledge: document.getElementById('min-pledge').value,
                    description: document.getElementById('funding-description').value,
                    milestones: collectMilestones()
                }
            };
            
            // Submit to backend
            console.log('Submitting project:', projectData);
            
            // Show success message
            alert('Project submitted successfully! Your project is now under review.');
            
            // Redirect to project page
            window.location.href = '/discover';
        }

        function collectMilestones() {
            const milestoneData = [];
            milestones.forEach(milestoneId => {
                const element = document.getElementById(milestoneId);
                if (element) {
                    const title = element.querySelector('.milestone-title').value;
                    const amount = element.querySelector('.milestone-amount').value;
                    const description = element.querySelector('.milestone-description').value;
                    const dueDate = element.querySelector('.milestone-due-date').value;
                    
                    if (title && amount && description && dueDate) {
                        milestoneData.push({
                            title,
                            amount: parseFloat(amount),
                            description,
                            due_date: dueDate
                        });
                    }
                }
            });
            return milestoneData;
        }

        // Enable submit button when terms are accepted
        document.getElementById('terms-accept').addEventListener('change', function(e) {
            const submitButton = document.getElementById('submit-button');
            const crowdfundingEnabled = document.getElementById('enable-crowdfunding').checked;
            const escrowAccepted = !crowdfundingEnabled || document.getElementById('escrow-accept').checked;
            
            submitButton.disabled = !e.target.checked || (crowdfundingEnabled && !escrowAccepted);
        });

        document.getElementById('escrow-accept').addEventListener('change', function(e) {
            const submitButton = document.getElementById('submit-button');
            const termsAccepted = document.getElementById('terms-accept').checked;
            
            submitButton.disabled = !termsAccepted || !e.target.checked;
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            displayTags();
        });
    </script>
</body>
</html> 
# Package Publisher Configuration
# Controls automated publishing of SDK packages to various registries

# Supported Languages and their publishing configurations
languages:
  typescript:
    registry: npm
    package_manager: npm
    publish_command: npm publish --access public
    build_command: null
    test_command: npm test
    version_file: package.json
    quality_gates:
      test_coverage_minimum: 80
      build_success_required: true
      security_scan_required: true
      documentation_required: true
  
  python:
    registry: pypi
    package_manager: pip
    publish_command: python -m twine upload dist/*
    build_command: python -m build
    test_command: python -m pytest
    version_file: setup.py
    quality_gates:
      test_coverage_minimum: 80
      build_success_required: true
      security_scan_required: true
      documentation_required: true
  
  go:
    registry: github
    package_manager: go
    publish_command: git tag v{version} && git push origin v{version}
    build_command: go build
    test_command: go test ./...
    version_file: go.mod
    quality_gates:
      test_coverage_minimum: 80
      build_success_required: true
      security_scan_required: true
      documentation_required: true
  
  java:
    registry: maven
    package_manager: mvn
    publish_command: mvn deploy
    build_command: mvn clean compile
    test_command: mvn test
    version_file: pom.xml
    quality_gates:
      test_coverage_minimum: 80
      build_success_required: true
      security_scan_required: true
      documentation_required: true
  
  csharp:
    registry: nuget
    package_manager: dotnet
    publish_command: dotnet nuget push
    build_command: dotnet build
    test_command: dotnet test
    version_file: *.csproj
    quality_gates:
      test_coverage_minimum: 80
      build_success_required: true
      security_scan_required: true
      documentation_required: true
  
  php:
    registry: packagist
    package_manager: composer
    publish_command: composer publish
    build_command: null
    test_command: composer test
    version_file: composer.json
    quality_gates:
      test_coverage_minimum: 80
      build_success_required: true
      security_scan_required: true
      documentation_required: true

# Services to publish
services:
  - arx-backend
  - arx-svg-parser
  - arx-cmms
  - arx-database

# Version management settings
version_management:
  auto_increment: true
  semantic_versioning: true
  changelog_generation: true
  git_tags: true
  require_changelog: true

# Quality gates for publishing
quality_gates:
  test_coverage_minimum: 80
  build_success_required: true
  security_scan_required: true
  documentation_required: true
  performance_regression_max: 10  # 10% max regression
  breaking_changes_allowed: false

# Publishing environments
environments:
  development:
    dry_run: true
    auto_publish: false
    notifications: false
  
  staging:
    dry_run: false
    auto_publish: false
    notifications: true
  
  production:
    dry_run: false
    auto_publish: true
    notifications: true

# Registry credentials (secrets)
registries:
  npm:
    token_env: NPM_TOKEN
    username_env: NPM_USERNAME
    password_env: NPM_PASSWORD
  
  pypi:
    username_env: PYPI_USERNAME
    password_env: PYPI_PASSWORD
  
  maven:
    username_env: MAVEN_USERNAME
    password_env: MAVEN_PASSWORD
  
  nuget:
    api_key_env: NUGET_API_KEY
  
  packagist:
    token_env: PACKAGIST_TOKEN

# Notification settings
notifications:
  email:
    enabled: true
    smtp_server: smtp.gmail.com
    smtp_port: 587
    from_email: sdk-publisher@arxos.com
    to_emails:
      - dev-team@arxos.com
      - sdk-team@arxos.com
  
  slack:
    enabled: true
    webhook_url_env: SLACK_WEBHOOK_URL
    channel: "#sdk-releases"
  
  webhook:
    enabled: false
    url_env: WEBHOOK_URL

# Reporting settings
reporting:
  generate_reports: true
  save_artifacts: true
  upload_to_s3: false
  retention_days: 30

# Error handling
error_handling:
  max_retries: 3
  retry_delay: 60  # seconds
  fail_fast: false
  rollback_on_failure: true 
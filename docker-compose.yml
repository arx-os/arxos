# Main Docker Compose file for ArxOS
# This is a convenience wrapper that includes base + dev configurations
# For production, use: docker-compose -f docker/docker-compose.base.yml -f docker/docker-compose.prod.yml up

version: '3.8'

# Include base configuration
services:
  # PostGIS spatial database
  postgis:
    extends:
      file: docker/docker-compose.base.yml
      service: postgis

  # ArxOS API Server
  arxos-api:
    extends:
      file: docker/docker-compose.base.yml
      service: arxos-api

  # ArxOS Daemon (development)
  arxos-daemon:
    extends:
      file: docker/docker-compose.dev.yml
      service: arxos-daemon

  # PgAdmin (development)
  pgadmin:
    extends:
      file: docker/docker-compose.dev.yml
      service: pgadmin
    profiles:
      - debug

  # Redis cache (optional)
  redis:
    extends:
      file: docker/docker-compose.dev.yml
      service: redis
    profiles:
      - cache

# Use the same networks and volumes
networks:
  arxos-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.28.0.0/16

volumes:
  postgis_data:
    driver: local
  arxos_data:
    driver: local
  ifc_imports:
    driver: local
  exports:
    driver: local
  pgadmin_data:
    driver: local
  redis_data:
    driver: local
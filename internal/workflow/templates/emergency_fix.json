{
  "name": "Emergency Hardware Fix",
  "description": "Emergency workflow for urgent hardware issues",
  "version": "1.0.0",
  "triggers": [
    {
      "type": "emergency_fix_created",
      "name": "Emergency Fix Trigger",
      "config": {
        "conditions": [
          {
            "field": "type",
            "operator": "equals",
            "value": "emergency_fix"
          },
          {
            "field": "priority",
            "operator": "in",
            "value": ["high", "critical"]
          }
        ]
      }
    }
  ],
  "workflow": {
    "stages": [
      {
        "name": "Immediate Response",
        "steps": [
          {
            "name": "Create Emergency Work Order",
            "action": "create_emergency_work_order",
            "config": {
              "title": "EMERGENCY: {{ pr.title }}",
              "room_path": "{{ pr.room_path }}",
              "priority": "critical",
              "issue": "{{ pr.metadata.issue }}",
              "reported_by": "{{ pr.created_by }}"
            }
          },
          {
            "name": "Alert IT Manager",
            "action": "alert_it_manager",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "issue": "{{ pr.metadata.issue }}",
              "priority": "{{ pr.metadata.priority }}",
              "message": "Emergency hardware issue reported in {{ pr.room_path }}"
            }
          },
          {
            "name": "Check Available Technicians",
            "action": "check_emergency_technicians",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "required_skills": "{{ pr.hardware_changes.required_skills }}",
              "urgency": "immediate"
            }
          }
        ]
      },
      {
        "name": "Rapid Assessment",
        "steps": [
          {
            "name": "Assess Hardware Issue",
            "action": "assess_hardware_issue",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "issue": "{{ pr.metadata.issue }}",
              "hardware_config": "{{ pr.hardware_changes }}"
            }
          },
          {
            "name": "Check Spare Parts",
            "action": "check_spare_parts",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "required_parts": "{{ pr.hardware_changes.parts_required }}",
              "urgency": "immediate"
            }
          },
          {
            "name": "Determine Fix Strategy",
            "action": "determine_fix_strategy",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "issue": "{{ pr.metadata.issue }}",
              "available_parts": "{{ spare_parts.available }}",
              "technician_availability": "{{ technicians.available }}"
            }
          }
        ]
      },
      {
        "name": "Emergency Deployment",
        "steps": [
          {
            "name": "Assign Emergency Technician",
            "action": "assign_emergency_technician",
            "config": {
              "work_order_id": "{{ work_order.id }}",
              "room_path": "{{ pr.room_path }}",
              "priority": "critical",
              "technician": "{{ find_emergency_technician(pr.room_path) }}"
            }
          },
          {
            "name": "Deploy Emergency Fix",
            "action": "deploy_emergency_fix",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "work_order_id": "{{ work_order.id }}",
              "fix_strategy": "{{ fix_strategy }}",
              "technician": "{{ work_order.assigned_to }}"
            }
          },
          {
            "name": "Implement Workaround",
            "action": "implement_workaround",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "work_order_id": "{{ work_order.id }}",
              "workaround": "{{ fix_strategy.workaround }}"
            }
          }
        ]
      },
      {
        "name": "Verification and Communication",
        "steps": [
          {
            "name": "Test Emergency Fix",
            "action": "test_emergency_fix",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "work_order_id": "{{ work_order.id }}",
              "fix_type": "{{ fix_strategy.type }}"
            }
          },
          {
            "name": "Notify Resolution",
            "action": "notify_resolution",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "work_order_id": "{{ work_order.id }}",
              "resolution": "{{ fix_strategy.resolution }}",
              "recipients": [
                "{{ pr.created_by }}",
                "{{ pr.metadata.reported_by }}",
                "facilities@school.edu",
                "it-manager@school.edu"
              ]
            }
          },
          {
            "name": "Schedule Permanent Fix",
            "action": "schedule_permanent_fix",
            "config": {
              "room_path": "{{ pr.room_path }}",
              "work_order_id": "{{ work_order.id }}",
              "permanent_fix": "{{ fix_strategy.permanent_fix }}",
              "priority": "high"
            }
          }
        ]
      }
    ]
  },
  "error_handling": {
    "on_failure": [
      {
        "name": "Escalate to Management",
        "action": "escalate_to_management",
        "config": {
          "room_path": "{{ pr.room_path }}",
          "issue": "{{ pr.metadata.issue }}",
          "error_message": "{{ error.message }}",
          "recipients": [
            "it-manager@school.edu",
            "facilities-manager@school.edu",
            "principal@school.edu"
          ]
        }
      },
      {
        "name": "Implement Backup Plan",
        "action": "implement_backup_plan",
        "config": {
          "room_path": "{{ pr.room_path }}",
          "backup_plan": "{{ fix_strategy.backup_plan }}"
        }
      }
    ]
  },
  "metadata": {
    "created_by": "system",
    "created_at": "2024-01-15T10:00:00Z",
    "version": "1.0.0",
    "tags": ["emergency", "hardware", "critical", "fix"]
  }
}

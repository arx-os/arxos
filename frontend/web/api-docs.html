<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arxos API Documentation</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 300;
        }
        .header p {
            margin: 0.5rem 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }
        .swagger-ui {
            margin: 0;
        }
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        .nav-tab {
            padding: 1rem 2rem;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            color: #6c757d;
            transition: all 0.2s;
        }
        .nav-tab.active {
            color: #495057;
            border-bottom: 2px solid #667eea;
            background: white;
        }
        .nav-tab:hover {
            color: #495057;
            background: #e9ecef;
        }
        .content-section {
            display: none;
            padding: 2rem;
        }
        .content-section.active {
            display: block;
        }
        .quick-start {
            max-width: 800px;
            margin: 0 auto;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            overflow-x: auto;
        }
        .endpoint-example {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin: 1rem 0;
            overflow: hidden;
        }
        .endpoint-header {
            background: #f8f9fa;
            padding: 1rem;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
        }
        .endpoint-body {
            padding: 1rem;
        }
        .method {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        .method.get { background: #d4edda; color: #155724; }
        .method.post { background: #cce5ff; color: #004085; }
        .method.put { background: #fff3cd; color: #856404; }
        .method.delete { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Arxos API Documentation</h1>
        <p>Building Information Modeling API for SVG-based system design and management</p>
    </div>

    <div class="nav-tabs">
        <button class="nav-tab active" onclick="showSection('swagger')">Interactive API</button>
        <button class="nav-tab" onclick="showSection('quick-start')">Quick Start</button>
        <button class="nav-tab" onclick="showSection('examples')">Examples</button>
        <button class="nav-tab" onclick="showSection('changelog')">Changelog</button>
    </div>

    <div id="swagger" class="content-section active">
        <div id="swagger-ui"></div>
    </div>

    <div id="quick-start" class="content-section">
        <div class="quick-start">
            <h2>Quick Start Guide</h2>
            
            <h3>Authentication</h3>
            <p>Most API endpoints require authentication using JWT tokens. Include the token in the Authorization header:</p>
            <div class="code-block">
Authorization: Bearer YOUR_JWT_TOKEN
            </div>

            <h3>Base URL</h3>
            <p>All API endpoints are relative to the base URL:</p>
            <div class="code-block">
Development: http://localhost:8080
Production: https://api.arxos.io
            </div>

            <h3>Creating Your First Device</h3>
            <div class="endpoint-example">
                <div class="endpoint-header">
                    <span class="method post">POST</span>
                    /api/bim/devices
                </div>
                <div class="endpoint-body">
                    <p><strong>Request Body:</strong></p>
                    <div class="code-block">
{
  "name": "HVAC Controller 1",
  "device_type": "controller",
  "x": 100,
  "y": 200,
  "manufacturer": "Arxos",
  "model": "AC-1000"
}
                    </div>
                    <p><strong>Response:</strong></p>
                    <div class="code-block">
{
  "object_id": "epnl1.spnl2.jb01.lf01",
  "name": "HVAC Controller 1",
  "device_type": "controller",
  "x": 100,
  "y": 200,
  "manufacturer": "Arxos",
  "model": "AC-1000",
  "created_at": "2024-01-15T10:30:00Z"
}
                    </div>
                </div>
            </div>

            <h3>Linking Objects</h3>
            <div class="endpoint-example">
                <div class="endpoint-header">
                    <span class="method post">POST</span>
                    /api/bim/link
                </div>
                <div class="endpoint-body">
                    <p><strong>Request Body:</strong></p>
                    <div class="code-block">
{
  "source_id": "epnl1.spnl2.jb01.lf01",
  "target_id": "epnl1.spnl2.jb02.lf01",
  "link_type": "downstream"
}
                    </div>
                </div>
            </div>

            <h3>Tracing Object Relationships</h3>
            <div class="endpoint-example">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    /api/bim/trace/{object_id}
                </div>
                <div class="endpoint-body">
                    <p><strong>Response:</strong></p>
                    <div class="code-block">
{
  "object_id": "epnl1.spnl2.jb01.lf01",
  "upstream_chain": [
    {
      "object_id": "epnl1.spnl2.pnl01.lf01",
      "name": "Main Panel",
      "type": "panel"
    }
  ],
  "downstream_chain": [
    {
      "object_id": "epnl1.spnl2.jb02.lf01",
      "name": "Sensor 1",
      "type": "sensor"
    }
  ],
  "flow_variables": {
    "voltage": "24V",
    "current": "2A"
  }
}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="examples" class="content-section">
        <div class="quick-start">
            <h2>Code Examples</h2>
            
            <h3>JavaScript/Node.js</h3>
            <div class="code-block">
const axios = require('axios');

const API_BASE = 'http://localhost:8080';

// Login to get token
const loginResponse = await axios.post(`${API_BASE}/api/auth/login`, {
  username: 'admin',
  password: 'password'
});

const token = loginResponse.data.token;

// Create a device
const deviceResponse = await axios.post(`${API_BASE}/api/bim/devices`, {
  name: 'HVAC Controller',
  device_type: 'controller',
  x: 100,
  y: 200
}, {
  headers: { Authorization: `Bearer ${token}` }
});

console.log('Device created:', deviceResponse.data);
            </div>

            <h3>Python</h3>
            <div class="code-block">
import requests

API_BASE = 'http://localhost:8080'

# Login to get token
login_response = requests.post(f'{API_BASE}/api/auth/login', json={
    'username': 'admin',
    'password': 'password'
})

token = login_response.json()['token']

# Create a device
device_response = requests.post(f'{API_BASE}/api/bim/devices', json={
    'name': 'HVAC Controller',
    'device_type': 'controller',
    'x': 100,
    'y': 200
}, headers={'Authorization': f'Bearer {token}'})

print('Device created:', device_response.json())
            </div>

            <h3>cURL</h3>
            <div class="code-block">
# Login
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "password"}'

# Create device (replace TOKEN with actual token)
curl -X POST http://localhost:8080/api/bim/devices \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "HVAC Controller",
    "device_type": "controller",
    "x": 100,
    "y": 200
  }'
            </div>
        </div>
    </div>

    <div id="changelog" class="content-section">
        <div class="quick-start">
            <h2>API Changelog</h2>
            
            <h3>Version 1.0.0 (Current)</h3>
            <ul>
                <li>Initial API release</li>
                <li>BIM object management (devices, rooms, panels)</li>
                <li>Object linking system</li>
                <li>Trace engine for relationship analysis</li>
                <li>Export functionality (SVG, BIM JSON)</li>
                <li>JWT authentication</li>
            </ul>

            <h3>Version 1.1.0 (Planned)</h3>
            <ul>
                <li>Enhanced object inference</li>
                <li>Bulk operations</li>
                <li>Real-time collaboration features</li>
                <li>Advanced export options</li>
            </ul>

            <h3>Version 2.0.0 (Future)</h3>
            <ul>
                <li>GraphQL support</li>
                <li>WebSocket real-time updates</li>
                <li>Advanced analytics</li>
                <li>Plugin system</li>
            </ul>
        </div>
    </div>

    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    <script>
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Initialize Swagger UI
        window.onload = function() {
            const ui = SwaggerUIBundle({
                url: '/docs/swagger.json',
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout"
            });
        };
    </script>
</body>
</html> 
{{define "navigation"}}
<a href="/hardware/dashboard" class="tier-nav-item hardware {{if eq .CurrentPage "dashboard"}}active{{end}}">
    <i class="fas fa-tachometer-alt"></i>
    Dashboard
</a>
<a href="/hardware/devices" class="tier-nav-item hardware {{if eq .CurrentPage "devices"}}active{{end}}">
    <i class="fas fa-microchip"></i>
    Devices
</a>
<a href="/hardware/gateways" class="tier-nav-item hardware {{if eq .CurrentPage "gateways"}}active{{end}}">
    <i class="fas fa-network-wired"></i>
    Gateways
</a>
<a href="/hardware/marketplace" class="tier-nav-item hardware {{if eq .CurrentPage "marketplace"}}active{{end}}">
    <i class="fas fa-store"></i>
    Marketplace
</a>
<a href="/hardware/templates" class="tier-nav-item hardware {{if eq .CurrentPage "templates"}}active{{end}}">
    <i class="fas fa-code"></i>
    Templates
</a>
<a href="/hardware/upgrade" class="tier-nav-item hardware {{if eq .CurrentPage "upgrade"}}active{{end}}">
    <i class="fas fa-arrow-up"></i>
    Upgrade
</a>
{{end}}

{{define "footer_links"}}
<a href="/hardware/marketplace/vendors" class="text-green-600 hover:text-green-800">Become a Vendor</a> |
<a href="/hardware/marketplace/certification" class="text-green-600 hover:text-green-800">Certification Process</a> |
<a href="/hardware/marketplace/support" class="text-green-600 hover:text-green-800">Support</a>
{{end}}

{{define "content"}}
            <!-- Marketplace Header -->
            <div class="tier-fade-in">
                <div class="tier-card hardware">
                    <div class="tier-card-header">
                        <h1 class="tier-card-title">ArxOS Hardware Marketplace</h1>
                        <p class="tier-card-subtitle">Certified IoT devices for your building automation</p>
                    </div>
                    <div class="tier-card-body">
                        <div class="flex items-center justify-between mb-4">
                            <p>Discover and purchase ArxOS-certified devices that seamlessly integrate with your building management system.</p>
                            <div class="flex items-center gap-2">
                                <span class="tier-status success">Verified</span>
                                <span class="tier-status info">SDK Included</span>
                            </div>
                        </div>
                        
                        <!-- Search and Filters -->
                        <div class="flex gap-4 mb-6" 
                             hx-get="/api/v1/marketplace/devices" 
                             hx-trigger="input delay:500ms from:input[name=search], change from:select[name=category], change from:select[name=certification]"
                             hx-target="#devices-grid"
                             hx-include="[name=search], [name=category], [name=certification]">
                            <div class="flex-1">
                                <input type="text" 
                                       name="search" 
                                       placeholder="Search devices..." 
                                       class="tier-form-input hardware"
                                       value="{{.SearchQuery}}">
                            </div>
                            <select name="category" class="tier-form-input hardware" style="width: 200px;">
                                <option value="">All Categories</option>
                                <option value="sensor" {{if eq .CategoryFilter "sensor"}}selected{{end}}>Sensors</option>
                                <option value="actuator" {{if eq .CategoryFilter "actuator"}}selected{{end}}>Actuators</option>
                                <option value="gateway" {{if eq .CategoryFilter "gateway"}}selected{{end}}>Gateways</option>
                                <option value="controller" {{if eq .CategoryFilter "controller"}}selected{{end}}>Controllers</option>
                            </select>
                            <select name="certification" class="tier-form-input hardware" style="width: 200px;">
                                <option value="">All Certifications</option>
                                <option value="Premium" {{if eq .CertificationFilter "Premium"}}selected{{end}}>Premium</option>
                                <option value="Standard" {{if eq .CertificationFilter "Standard"}}selected{{end}}>Standard</option>
                                <option value="Basic" {{if eq .CertificationFilter "Basic"}}selected{{end}}>Basic</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Featured Devices -->
            <div class="tier-card hardware tier-fade-in mt-6">
                <div class="tier-card-header">
                    <h2 class="tier-card-title">Featured Devices</h2>
                    <p class="tier-card-subtitle">Popular and highly-rated certified devices</p>
                </div>
                <div class="tier-card-body">
                    <div class="tier-grid tier-grid-3" 
                         hx-get="/api/v1/marketplace/devices/featured" 
                         hx-trigger="load"
                         hx-target="this"
                         hx-swap="innerHTML">
                        {{range .FeaturedDevices}}
                        <div class="device-card" hx-get="/hardware/marketplace/devices/{{.ID}}" hx-target="body" hx-push-url="true">
                            <div class="relative">
                                <div class="device-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="certification-badge {{.Certification | lower}}">{{.Certification}}</div>
                            </div>
                            <div class="p-4">
                                <h3 class="font-semibold text-lg mb-2">{{.Name}}</h3>
                                <p class="text-sm text-gray-600 mb-2">{{.Description}}</p>
                                <div class="flex items-center justify-between mb-3">
                                    <div class="flex items-center gap-1">
                                        {{range $i := (seq 5)}}
                                        {{if lt $i .Rating}}
                                        <i class="fas fa-star text-yellow-400"></i>
                                        {{else}}
                                        <i class="fas fa-star text-gray-300"></i>
                                        {{end}}
                                        {{end}}
                                        <span class="text-sm text-gray-600 ml-1">({{.ReviewsCount}})</span>
                                    </div>
                                    <span class="tier-status {{if eq .Availability "available"}}success{{else}}warning{{end}}">{{.Availability}}</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-green-600">${{.Price}}</span>
                                    <button class="tier-btn tier-btn-primary hardware" 
                                            hx-post="/api/v1/marketplace/cart/add" 
                                            hx-vals='{"device_id": "{{.ID}}"}'
                                            hx-target="#cart-notification">
                                        <i class="fas fa-shopping-cart"></i>
                                        Add to Cart
                                    </button>
                                </div>
                            </div>
                        </div>
                        {{end}}
                    </div>
                </div>
            </div>

            <!-- Device Categories -->
            <div class="tier-grid tier-grid-4 mt-6">
                <div class="tier-card hardware tier-fade-in category-card">
                    <div class="tier-card-body text-center">
                        <i class="fas fa-thermometer-half text-4xl text-green-600 mb-4"></i>
                        <h3 class="font-semibold mb-2">Environmental Sensors</h3>
                        <p class="text-sm text-gray-600 mb-4">Temperature, humidity, air quality, and more</p>
                        <a href="#" class="tier-btn tier-btn-primary hardware" data-category="sensor">
                            Browse Sensors
                        </a>
                    </div>
                </div>
                <div class="tier-card hardware tier-fade-in category-card">
                    <div class="tier-card-body text-center">
                        <i class="fas fa-lightbulb text-4xl text-green-600 mb-4"></i>
                        <h3 class="font-semibold mb-2">Smart Actuators</h3>
                        <p class="text-sm text-gray-600 mb-4">Lights, switches, valves, and controls</p>
                        <a href="#" class="tier-btn tier-btn-primary hardware" data-category="actuator">
                            Browse Actuators
                        </a>
                    </div>
                </div>
                <div class="tier-card hardware tier-fade-in category-card">
                    <div class="tier-card-body text-center">
                        <i class="fas fa-network-wired text-4xl text-green-600 mb-4"></i>
                        <h3 class="font-semibold mb-2">Communication Gateways</h3>
                        <p class="text-sm text-gray-600 mb-4">Protocol bridges and connectivity hubs</p>
                        <a href="#" class="tier-btn tier-btn-primary hardware" data-category="gateway">
                            Browse Gateways
                        </a>
                    </div>
                </div>
                <div class="tier-card hardware tier-fade-in category-card">
                    <div class="tier-card-body text-center">
                        <i class="fas fa-microchip text-4xl text-green-600 mb-4"></i>
                        <h3 class="font-semibold mb-2">Smart Controllers</h3>
                        <p class="text-sm text-gray-600 mb-4">Edge computing and local control</p>
                        <a href="#" class="tier-btn tier-btn-primary hardware" data-category="controller">
                            Browse Controllers
                        </a>
                    </div>
                </div>
            </div>

            <!-- All Devices -->
            <div class="tier-card hardware tier-fade-in mt-6">
                <div class="tier-card-header">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="tier-card-title">All Certified Devices</h2>
                            <p class="tier-card-subtitle" id="device-count">Loading devices...</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-sm text-gray-600">Sort by:</span>
                            <select id="sort-filter" class="tier-form-input hardware" style="width: 150px;">
                                <option value="popularity">Popularity</option>
                                <option value="price_low">Price: Low to High</option>
                                <option value="price_high">Price: High to Low</option>
                                <option value="rating">Rating</option>
                                <option value="newest">Newest</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="tier-card-body">
                    <div id="devices-grid" class="tier-grid tier-grid-3" 
                         hx-get="/api/v1/marketplace/devices" 
                         hx-trigger="load"
                         hx-target="this"
                         hx-swap="innerHTML">
                        {{range .Devices}}
                        <div class="device-card" hx-get="/hardware/marketplace/devices/{{.ID}}" hx-target="body" hx-push-url="true">
                            <div class="relative">
                                <div class="device-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="certification-badge {{.Certification | lower}}">{{.Certification}}</div>
                            </div>
                            <div class="p-4">
                                <h3 class="font-semibold text-lg mb-2">{{.Name}}</h3>
                                <p class="text-sm text-gray-600 mb-2">{{.Description}}</p>
                                <div class="flex items-center justify-between mb-3">
                                    <div class="flex items-center gap-1">
                                        {{range $i := (seq 5)}}
                                        {{if lt $i .Rating}}
                                        <i class="fas fa-star text-yellow-400"></i>
                                        {{else}}
                                        <i class="fas fa-star text-gray-300"></i>
                                        {{end}}
                                        {{end}}
                                        <span class="text-sm text-gray-600 ml-1">({{.ReviewsCount}})</span>
                                    </div>
                                    <span class="tier-status {{if eq .Availability "available"}}success{{else}}warning{{end}}">{{.Availability}}</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-green-600">${{.Price}}</span>
                                    <button class="tier-btn tier-btn-primary hardware" 
                                            hx-post="/api/v1/marketplace/cart/add" 
                                            hx-vals='{"device_id": "{{.ID}}"}'
                                            hx-target="#cart-notification">
                                        <i class="fas fa-shopping-cart"></i>
                                        Add to Cart
                                    </button>
                                </div>
                            </div>
                        </div>
                        {{else}}
                        <div class="text-center py-8 col-span-3">
                            <i class="fas fa-search text-4xl text-gray-400 mb-4"></i>
                            <h3 class="text-lg font-semibold text-gray-600">No devices found</h3>
                            <p class="text-gray-500">Try adjusting your search criteria</p>
                        </div>
                        {{end}}
                    </div>
                </div>
            </div>

            <!-- Certification Info -->
            <div class="tier-card hardware tier-fade-in mt-6">
                <div class="tier-card-header">
                    <h2 class="tier-card-title">ArxOS Certification Process</h2>
                    <p class="tier-card-subtitle">Quality assurance and compatibility guarantee</p>
                </div>
                <div class="tier-card-body">
                    <div class="tier-grid tier-grid-3">
                        <div class="certification-step">
                            <div class="cert-step-number">1</div>
                            <h3 class="font-semibold mb-2">Comprehensive Testing</h3>
                            <p class="text-sm text-gray-600">Safety, performance, security, and compatibility testing</p>
                        </div>
                        <div class="certification-step">
                            <div class="cert-step-number">2</div>
                            <h3 class="font-semibold mb-2">SDK Validation</h3>
                            <p class="text-sm text-gray-600">ArxOS SDK integration and API compatibility verification</p>
                        </div>
                        <div class="certification-step">
                            <div class="cert-step-number">3</div>
                            <h3 class="font-semibold mb-2">Quality Assurance</h3>
                            <p class="text-sm text-gray-600">Documentation, support, and ongoing maintenance standards</p>
                        </div>
                    </div>
                    <div class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-shield-alt text-green-600"></i>
                            <div>
                                <h4 class="font-semibold text-green-800">Certification Guarantee</h4>
                                <p class="text-sm text-green-700">All marketplace devices are guaranteed to work with ArxOS and include comprehensive documentation and support.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

{{end}}

<style>
    .category-card {
        transition: transform 0.2s ease;
        cursor: pointer;
    }

    .category-card:hover {
        transform: translateY(-4px);
    }

    .certification-step {
        text-align: center;
        padding: 1rem;
    }

    .cert-step-number {
        width: 3rem;
        height: 3rem;
        background-color: #10b981;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.25rem;
        margin: 0 auto 1rem;
    }

    .device-card {
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        overflow: hidden;
        transition: all 0.2s ease;
        cursor: pointer;
    }

    .device-card:hover {
        border-color: #10b981;
        transform: translateY(-2px);
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    }

    .device-image {
        width: 100%;
        height: 200px;
        background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        color: #10b981;
    }

    .certification-badge {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
    }

    .certification-badge.premium {
        background-color: #7c3aed;
        color: white;
    }

    .certification-badge.standard {
        background-color: #10b981;
        color: white;
    }

    .certification-badge.basic {
        background-color: #3b82f6;
        color: white;
    }
</style>

{{template "base.html" .}}

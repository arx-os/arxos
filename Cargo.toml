[workspace]
members = [
    "src/core",
    "src/terminal",
    "src/service",
    # "src/embedded",  # Requires embedded toolchain
    # "src/tools",     # Fix clap derive issues later
]
resolver = "2"

[workspace.package]
version = "0.1.0"
authors = ["Arxos Contributors"]
edition = "2021"
license = "MIT"
repository = "https://github.com/arxos/arxos-mesh"

[workspace.dependencies]
# Core dependencies
heapless = "0.7"
nb = "1.0"
embedded-hal = "0.2"
postcard = "1.0"

# Database and serialization
rusqlite = { version = "0.31", features = ["bundled"] }
uuid = { version = "1.0", features = ["v4", "serde"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# No web dependencies - pure RF mesh only!

# Terminal dependencies
crossterm = "0.27"
ratatui = "0.24"
clap = { version = "4.4", features = ["derive"] }

# Async runtime
tokio = { version = "1.35", features = ["full"] }
embassy-executor = "0.4"

# Logging
log = "0.4"
env_logger = "0.10"
defmt = "0.3"

# Testing
mockall = "0.12"
proptest = "1.4"

# Mobile AR dependencies (iOS/Android)
objc = "0.2"
block = "0.1"

[profile.release]
opt-level = "z"     # Optimize for size
lto = true          # Link-time optimization
codegen-units = 1   # Single codegen unit for better optimization
strip = true        # Strip symbols
panic = "abort"     # Smaller panic handler

[profile.embedded]
inherits = "release"
opt-level = "s"     # Optimize for size with decent speed
debug = false       # No debug info for smaller binary
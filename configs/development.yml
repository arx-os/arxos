# ArxOS Development Configuration
# This configuration uses PostGIS as primary database

# Core settings
mode: hybrid
version: "0.1.0"
environment: development
state_dir: ".arxos"
cache_dir: ".arxos/cache"

# PostGIS settings (Primary)
postgis:
  enabled: true
  host: "${POSTGIS_HOST:-localhost}"
  port: ${POSTGIS_PORT:-5432}
  database: "${POSTGRES_DB:-arxos}"
  user: "${POSTGRES_USER:-arxos}"
  password: "${POSTGRES_PASSWORD:-arxos_dev}"
  ssl_mode: "${POSTGIS_SSL_MODE:-disable}"

  # Spatial settings
  srid: 900913  # ArxOS Building Local coordinate system
  precision_mm: true  # Use millimeter precision

  # Connection pool
  max_connections: 25
  max_idle_conns: 5
  conn_max_lifetime: 30m

  # Performance
  enable_query_cache: true
  cache_ttl: 5m
  prepared_statements: true


# Database common settings
database:
  type: "${ARX_DB_TYPE:-postgis}"  # postgis only
  migrations_path: "./internal/migrations"
  auto_migrate: true
  log_queries: true
  slow_query_threshold: 100ms

# API Server settings
server:
  host: "${API_HOST:-localhost}"
  port: ${API_PORT:-8080}
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s
  max_header_bytes: 1048576  # 1MB

  # Middleware
  enable_cors: true
  enable_gzip: true
  enable_rate_limit: true
  enable_request_id: true
  enable_recovery: true

  # Health checks
  health_check_path: "/health"
  ready_check_path: "/ready"
  metrics_path: "/metrics"

# Daemon settings
daemon:
  enabled: true
  watch_paths:
    - "./test_data/ifc"
    - "./imports"
  poll_interval: 5s
  auto_import: true
  auto_export: true
  max_workers: 4

  # File processing
  supported_formats:
    - ifc
    - ifczip
    - ifcxml
  max_file_size_mb: 100

  # Export settings
  export_formats:
    - bim
    - csv
    - json
  export_path: "./exports"

# Security settings
security:
  jwt_secret: "${JWT_SECRET:-dev-secret-change-in-production}"
  jwt_expiry: 24h
  session_timeout: 8h
  bcrypt_cost: 10  # Lower for dev

  # Rate limiting
  rate_limit: 100
  rate_limit_burst: 200
  rate_limit_window: 1m

  # CORS
  allowed_origins:
    - "http://localhost:3000"
    - "http://localhost:8080"
    - "http://localhost:5173"  # Vite
  allowed_methods:
    - GET
    - POST
    - PUT
    - DELETE
    - OPTIONS
  allowed_headers:
    - Content-Type
    - Authorization
    - X-Request-ID

  # TLS
  enable_tls: false
  tls_cert_path: ""
  tls_key_path: ""

# Storage settings
storage:
  type: local
  local:
    base_path: ".arxos/storage"
    temp_path: ".arxos/temp"

  # S3 (optional)
  s3:
    enabled: false
    bucket: ""
    region: ""
    access_key: ""
    secret_key: ""

# Cache settings
cache:
  type: "${CACHE_TYPE:-memory}"  # memory or redis

  memory:
    max_size_mb: 256
    ttl: 10m
    cleanup_interval: 5m

  redis:
    enabled: false
    host: "${REDIS_HOST:-localhost}"
    port: ${REDIS_PORT:-6379}
    password: "${REDIS_PASSWORD:-}"
    db: 0
    ttl: 10m

# Logging
logging:
  level: "${ARX_LOG_LEVEL:-debug}"
  format: text  # text or json
  output: stdout
  file:
    enabled: true
    path: ".arxos/logs/arxos.log"
    max_size_mb: 100
    max_backups: 3
    max_age_days: 30
    compress: true

  # Log specific components
  components:
    database: debug
    api: info
    daemon: debug
    converter: debug
    exporter: debug

# Monitoring
monitoring:
  metrics_enabled: true
  tracing_enabled: false
  profiling_enabled: true

  # Prometheus
  prometheus:
    enabled: true
    port: ${PROMETHEUS_PORT:-9090}

  # Jaeger (optional)
  jaeger:
    enabled: false
    endpoint: ""
    service_name: "arxos-dev"

# Feature flags
features:
  # Core features
  enable_postgis: true
  enable_hybrid_mode: true

  # Import/Export
  enable_ifc_import: true
  enable_bim_export: true
  enable_csv_export: true
  enable_json_export: true
  enable_pdf_export: false

  # Advanced features
  enable_spatial_queries: true
  enable_version_control: true
  enable_conflict_resolution: true
  enable_compression: true

  # Development features
  enable_debug_endpoints: true
  enable_test_data: true
  enable_mock_mode: false

  # Beta features
  enable_ai_suggestions: false
  enable_cloud_sync: false
  enable_realtime_updates: false

# Development tools
development:
  hot_reload: true
  debug_mode: true
  verbose_errors: true
  stack_traces: true

  # Database tools
  seed_data: true
  reset_db_on_start: false

  # API tools
  swagger_enabled: true
  graphql_playground: false

  # Testing
  test_mode: false
  test_database: ":memory:"
  parallel_tests: true

# Repository settings
repository:
  enable_versioning: true
  max_versions: 100
  compression: true

  # Git-like features
  enable_branches: true
  enable_tags: true
  enable_merge: true
  default_branch: "main"

# Building/IFC settings
building:
  arxos_id_prefix: "ARXOS"
  max_building_size_mb: 500
  max_floors: 200
  max_rooms_per_floor: 1000
  max_equipment_per_room: 500

  # Spatial settings
  coordinate_precision_mm: 1
  area_precision_sqmm: 1
  volume_precision_cbmm: 1

# Performance tuning
performance:
  max_concurrent_imports: 2
  max_concurrent_exports: 4
  batch_size: 1000

  # Query optimization
  enable_query_cache: true
  query_cache_size: 100
  prepared_statement_cache_size: 50

  # Worker pools
  worker_pool_size: 10
  job_queue_size: 100

  # Timeouts
  import_timeout: 10m
  export_timeout: 5m
  query_timeout: 30s